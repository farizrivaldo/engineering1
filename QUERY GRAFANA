#TAMAN
SELECT 
    time,
    difference
FROM (
    SELECT 
        `time@timestamp` AS time,
        CASE 
            WHEN @prev_value IS NULL THEN 0
            ELSE data_format_0 - @prev_value
        END AS difference,
        @prev_value := data_format_0
    FROM 
        (
            SELECT `time@timestamp`, data_format_0
            FROM `parammachine_saka`.`cMT-BWT_Met_Taman_data`
            WHERE `time@timestamp` >= UNIX_TIMESTAMP(DATE_FORMAT(NOW(), '%Y-%m-01')) -- Tanggal 1 bulan ini
              AND `time@timestamp` < UNIX_TIMESTAMP(DATE(NOW())) -- Hingga kemarin
            UNION ALL
            SELECT `time@timestamp`, data_format_0
            FROM `parammachine_saka`.`cMT-DB-WATER-UTY_Met_Taman_data`
            WHERE `time@timestamp` >= UNIX_TIMESTAMP(DATE_FORMAT(NOW(), '%Y-%m-01')) -- Tanggal 1 bulan ini
              AND `time@timestamp` < UNIX_TIMESTAMP(DATE(NOW())) -- Hingga kemarin
        ) AS combined_data
    ORDER BY 
        `time@timestamp`
) AS inner_query;